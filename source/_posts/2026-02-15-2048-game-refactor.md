---
title: 🎮 2048 游戏重构：修复动画与合并逻辑
date: 2026-02-15 13:00:00
tags:
  - 2048
  - 游戏开发
  - 重构
  - JavaScript
categories:
  - 项目展示
---

## 🎯 重构背景

之前上线的 2048 游戏收到了两个反馈：
1. 动画效果太快，看不清滑动过程
2. 合并逻辑有问题，连续合并的行为不符合预期

今天花了点时间重构了代码，修复了这些问题。

## 🐛 修复的问题

### 1. 动画速度过慢
**问题**：原来的方块出现动画只有 0.15s，太快导致看不清方块的移动和合并过程。

**修复**：
- 方块出现动画从 0.15s 延长到 0.2s
- 新增合并动画（pop 效果），合并时会有缩放动画
- 添加滑动过渡效果

```css
.tile {
    animation: appear 0.2s ease;
    transition: transform 0.15s ease-in-out;
}

.tile.merged {
    animation: pop 0.2s ease;
}

@keyframes pop {
    0% { transform: scale(0.8); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}
```

### 2. 合并逻辑bug
**问题**：当遇到连续相同数字时（如 `[2, 2, 2, 2]`），原来的逻辑会错误地合并成 `[8, 0, 0, 0]`，而正确的行为应该是 `[4, 4, 0, 0]`。

**修复**：
在合并时跳过已经合并过的元素，避免连续合并：

```javascript
// Merge adjacent equal numbers
for (let i = 0; i < newRow.length - 1; i++) {
    if (newRow[i] === newRow[i + 1] && newRow[i] !== 0) {
        newRow[i] *= 2;
        this.score += newRow[i];
        newRow[i + 1] = 0;
        // Skip the next one since we just merged it
        i++; // ✅ 关键修复：跳过已合并的元素
    }
}
```

## ✨ 新增功能

### 版本号显示
在标题旁添加了版本号，方便追踪更新：
```
2048 v1.1
```

## 🎮 游戏地址

**立即体验：** [https://2048-game-sigma-wheat.vercel.app](https://2048-game-sigma-wheat.vercel.app)

## 📝 代码仓库

GitHub：[https://github.com/occcat/2048-game](https://github.com/occcat/2048-game)

---
欢迎体验~ 有问题随时反馈！🎯
